<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Using the cartopy shapereader &#8212; cartopy 0.15.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.15.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="cartopy 0.15.0 documentation" href="../index.html" />
    <link rel="next" title="Using cartopy with matplotlib" href="../matplotlib/intro.html" />
    <link rel="prev" title="Cartopy projection list" href="../crs/projections.html" />
 

     <META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
     <META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">

     <link rel="stylesheet" href="../_static/layout.css" type="text/css" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../cartopy_outline.html" title="Module outline"
             accesskey="O">outline</a> |</li>
        <li class="right" >
          <a href="../matplotlib/intro.html" title="Using cartopy with matplotlib"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../crs/projections.html" title="Cartopy projection list"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../gallery.html">gallery</a>|&nbsp;</li>
        
 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<a href="../index.html">
<img src="../_static/cartopy.png" 
border="0" alt="Cartopy" style="margin-left: -60px;"/>
</a>


  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Using the cartopy shapereader</a><ul>
<li><a class="reference internal" href="#helper-functions-for-shapefile-acquisition">Helper functions for shapefile acquisition</a></li>
<li><a class="reference internal" href="#id1">Using the shapereader</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../crs/projections.html"
                        title="previous chapter">Cartopy projection list</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../matplotlib/intro.html"
                        title="next chapter">Using cartopy with matplotlib</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/tutorials/using_the_shapereader.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
        <!-- add an empty div to clear the logo on the right. -->
        <div style="float: right; right:0px; height: 140px; width:100px; display: block;"></div>
        
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="using-the-cartopy-shapereader">
<span id="using-the-shapereader"></span><h1>Using the cartopy shapereader<a class="headerlink" href="#using-the-cartopy-shapereader" title="Permalink to this headline">¶</a></h1>
<p>Cartopy provides an object oriented shapefile reader based on top of the
<a class="reference external" href="https://github.com/GeospatialPython/pyshp">pyshp</a> module to provide easy,
programmatic, access to standard vector datasets.</p>
<dl class="class">
<dt id="cartopy.io.shapereader.Reader">
<em class="property">class </em><code class="descclassname">cartopy.io.shapereader.</code><code class="descname">Reader</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cartopy/io/shapereader.html#Reader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cartopy.io.shapereader.Reader" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides an interface for accessing the contents of a shapefile.</p>
<p>The primary methods used on a Reader instance are
<a class="reference internal" href="#cartopy.io.shapereader.Reader.records" title="cartopy.io.shapereader.Reader.records"><code class="xref py py-meth docutils literal"><span class="pre">records()</span></code></a> and <a class="reference internal" href="#cartopy.io.shapereader.Reader.geometries" title="cartopy.io.shapereader.Reader.geometries"><code class="xref py py-meth docutils literal"><span class="pre">geometries()</span></code></a>.</p>
<dl class="method">
<dt id="cartopy.io.shapereader.Reader.geometries">
<code class="descname">geometries</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cartopy/io/shapereader.html#Reader.geometries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cartopy.io.shapereader.Reader.geometries" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator of shapely geometries from the shapefile.</p>
<p>This interface is useful for accessing the geometries of the
shapefile where knowledge of the associated metadata is desired.
In the case where further metadata is needed use the
<a class="reference internal" href="#cartopy.io.shapereader.Reader.records" title="cartopy.io.shapereader.Reader.records"><code class="xref py py-meth docutils literal"><span class="pre">records()</span></code></a>
interface instead, extracting the geometry from the record with the
<a class="reference internal" href="#cartopy.io.shapereader.Record.geometry" title="cartopy.io.shapereader.Record.geometry"><code class="xref py py-meth docutils literal"><span class="pre">geometry()</span></code></a> method.</p>
</dd></dl>

<dl class="method">
<dt id="cartopy.io.shapereader.Reader.records">
<code class="descname">records</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cartopy/io/shapereader.html#Reader.records"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cartopy.io.shapereader.Reader.records" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator of <a class="reference internal" href="#cartopy.io.shapereader.Record" title="cartopy.io.shapereader.Record"><code class="xref py py-class docutils literal"><span class="pre">Record</span></code></a> instances.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="cartopy.io.shapereader.Record">
<em class="property">class </em><code class="descclassname">cartopy.io.shapereader.</code><code class="descname">Record</code><span class="sig-paren">(</span><em>shape</em>, <em>geometry_factory</em>, <em>attributes</em>, <em>fields</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cartopy/io/shapereader.html#Record"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cartopy.io.shapereader.Record" title="Permalink to this definition">¶</a></dt>
<dd><p>A single logical entry from a shapefile, combining the attributes with
their associated geometry.</p>
<dl class="attribute">
<dt id="cartopy.io.shapereader.Record.attributes">
<code class="descname">attributes</code><em class="property"> = None</em><a class="headerlink" href="#cartopy.io.shapereader.Record.attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary mapping attribute names to attribute values.</p>
</dd></dl>

<dl class="attribute">
<dt id="cartopy.io.shapereader.Record.bounds">
<code class="descname">bounds</code><a class="headerlink" href="#cartopy.io.shapereader.Record.bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>The bounds of this Record&#8217;s
<a class="reference internal" href="#cartopy.io.shapereader.Record.geometry" title="cartopy.io.shapereader.Record.geometry"><code class="xref py py-meth docutils literal"><span class="pre">geometry()</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="cartopy.io.shapereader.Record.geometry">
<code class="descname">geometry</code><a class="headerlink" href="#cartopy.io.shapereader.Record.geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>A shapely.geometry instance for this Record.</p>
<p>The geometry may be <code class="docutils literal"><span class="pre">None</span></code> if a null shape is defined in the
shapefile.</p>
</dd></dl>

</dd></dl>

<div class="section" id="helper-functions-for-shapefile-acquisition">
<h2>Helper functions for shapefile acquisition<a class="headerlink" href="#helper-functions-for-shapefile-acquisition" title="Permalink to this headline">¶</a></h2>
<p>Cartopy provides an interface for access to frequently used data such as the
<a class="reference external" href="https://www.ngdc.noaa.gov/mgg/shorelines/gshhs.html">GSHHS</a> dataset and from
the <a class="reference external" href="http://www.naturalearthdata.com/">NaturalEarthData</a> website.
These interfaces allow the user to define the data programmatically, and if the data does not exist
on disk, it will be retrieved from the appropriate source (normally by
downloading the data from the internet). Currently the interfaces available are:</p>
<dl class="function">
<dt id="cartopy.io.shapereader.natural_earth">
<code class="descclassname">cartopy.io.shapereader.</code><code class="descname">natural_earth</code><span class="sig-paren">(</span><em>resolution='110m'</em>, <em>category='physical'</em>, <em>name='coastline'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cartopy/io/shapereader.html#natural_earth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cartopy.io.shapereader.natural_earth" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the path to the requested natural earth shapefile,
downloading and unziping if necessary.</p>
<p>To identify valid components for this function, either browse
NaturalEarthData.com, or if you know what you are looking for, go to
<a class="reference external" href="https://github.com/nvkelso/natural-earth-vector/tree/master/zips">https://github.com/nvkelso/natural-earth-vector/tree/master/zips</a> to
see the actual files which will be downloaded.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Some of the Natural Earth shapefiles have special features which are
described in the name. For example, the 110m resolution
&#8220;admin_0_countries&#8221; data also has a sibling shapefile called
&#8220;admin_0_countries_lakes&#8221; which excludes lakes in the country
outlines. For details of what is available refer to the Natural Earth
website, and look at the &#8220;download&#8221; link target to identify
appropriate names.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="cartopy.io.shapereader.gshhs">
<code class="descclassname">cartopy.io.shapereader.</code><code class="descname">gshhs</code><span class="sig-paren">(</span><em>scale='c'</em>, <em>level=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cartopy/io/shapereader.html#gshhs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cartopy.io.shapereader.gshhs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the path to the requested GSHHS shapefile,
downloading and unziping if necessary.</p>
</dd></dl>

</div>
<div class="section" id="id1">
<h2>Using the shapereader<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>We can acquire the countries dataset from Natural Earth found at
<a class="reference external" href="http://www.naturalearthdata.com/downloads/110m-cultural-vectors/110m-admin-0-countries/">http://www.naturalearthdata.com/downloads/110m-cultural-vectors/110m-admin-0-countries/</a>
by using the <a class="reference internal" href="#cartopy.io.shapereader.natural_earth" title="cartopy.io.shapereader.natural_earth"><code class="xref py py-func docutils literal"><span class="pre">natural_earth()</span></code></a> function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cartopy.io.shapereader</span> <span class="k">as</span> <span class="nn">shpreader</span>

<span class="n">shpfilename</span> <span class="o">=</span> <span class="n">shpreader</span><span class="o">.</span><span class="n">natural_earth</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;110m&#39;</span><span class="p">,</span>
                                      <span class="n">category</span><span class="o">=</span><span class="s1">&#39;cultural&#39;</span><span class="p">,</span>
                                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;admin_0_countries&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>From here, we can make use of the <a class="reference internal" href="#cartopy.io.shapereader.Reader" title="cartopy.io.shapereader.Reader"><code class="xref py py-class docutils literal"><span class="pre">Reader</span></code></a> to get the first country
in the shapefile:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">reader</span> <span class="o">=</span> <span class="n">shpreader</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span><span class="n">shpfilename</span><span class="p">)</span>
<span class="n">countries</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">records</span><span class="p">()</span>
<span class="n">country</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">countries</span><span class="p">)</span>
</pre></div>
</div>
<p>We can get the country&#8217;s attributes dictionary with the
<a class="reference internal" href="#cartopy.io.shapereader.Record.attributes" title="cartopy.io.shapereader.Record.attributes"><code class="xref py py-data docutils literal"><span class="pre">Record.attributes</span></code></a> attribute:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">type</span><span class="p">(</span><span class="n">country</span><span class="o">.</span><span class="n">attributes</span><span class="p">)</span>
<span class="go">&lt;type &#39;dict&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">country</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="go">[&#39;abbrev&#39;, ..., &#39;name_long&#39;, ... &#39;pop_est&#39;, ...]</span>
</pre></div>
</div>
<p>We could now find the 5 least populated countries with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">reader</span> <span class="o">=</span> <span class="n">shpreader</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span><span class="n">shpfilename</span><span class="p">)</span>

<span class="c1"># define a function which returns the population given the country</span>
<span class="n">population</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">country</span><span class="p">:</span> <span class="n">country</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;pop_est&#39;</span><span class="p">]</span>

<span class="c1"># sort the countries by population and get the first 5</span>
<span class="n">countries_by_pop</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">records</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">population</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<p>Which we can print with</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">country</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;name_long&#39;</span><span class="p">]</span>
<span class="gp">... </span>           <span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">countries_by_pop</span><span class="p">])</span>
<span class="go">&#39;Western Sahara, French Southern and Antarctic Lands, Falkland Islands, Antarctica, Greenland&#39;</span>
</pre></div>
</div>
<p><strong>Exercises</strong>:</p>
<blockquote>
<div><ul>
<li><p class="first"><strong>SHP.1</strong>: Repeat the last example to show the 4 most populated African countries in to the shapefile.</p>
<p>Hint: Look at the possible attributes to find out which continent a country belongs.</p>
<p>Answer:</p>
<blockquote>
<div><div class="highlight-none"><div class="highlight"><pre><span></span>Democratic Republic of the Congo, Egypt, Ethiopia, Nigeria
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first"><strong>SHP.2</strong>: Using the countries shapefile, find the most populated country grouped
by the first letter of the &#8220;name_long&#8221;.</p>
<p>Hint: <a class="reference external" href="https://docs.python.org/3/library/itertools.html#itertools.groupby" title="(in Python v3.6)"><code class="xref py py-func docutils literal"><span class="pre">itertools.groupby()</span></code></a> can help with the grouping.</p>
<p>Answer:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>A Argentina
B Brazil
C China
D Democratic Republic of the Congo
E Ethiopia
F France
G Germany
H Hungary
I India
J Japan
K Kenya
L Lao PDR
M Mexico
N Nigeria
O Oman
P Pakistan
Q Qatar
R Russian Federation
S South Africa
T Turkey
U United States
V Vietnam
W Western Sahara
Y Yemen
Z Zimbabwe
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../cartopy_outline.html" title="Module outline"
             >outline</a> |</li>
        <li class="right" >
          <a href="../matplotlib/intro.html" title="Using cartopy with matplotlib"
             >next</a> |</li>
        <li class="right" >
          <a href="../crs/projections.html" title="Cartopy projection list"
             >previous</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../gallery.html">gallery</a>|&nbsp;</li>
        
 
      </ul>
    </div>

    <div class="footer">
    <p style="text-align: left; float: left; margin: 0px; padding: 0 0 0 5px;">Documentation licensed under the <a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/2/" rel="license">Open Government Licence</a></p>
        &copy; <a href="../copyright.html">British Crown Copyright</a> 2011 - 2017, Met Office
    </div>

    <!-- Point to the *latest* version switcher. This will allow the latest versions to appear on older documentation. -->
    <script type="text/javascript" src="https://scitools.org.uk/cartopy/docs/latest/_static/version_switch.js"></script>


  </body>
</html>