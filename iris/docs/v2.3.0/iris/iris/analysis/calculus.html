
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>iris.analysis.calculus &#8212; Iris 2.3.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="copyright" title="Copyright" href="../../../copyright.html" />
    <link rel="next" title="iris.analysis.cartography" href="cartography.html" />
    <link rel="prev" title="iris.analysis" href="../analysis.html" />
 
    <META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
    <META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE"> 

    <link rel="stylesheet" href="../../../_static/style.css" type="text/css" />
    <script type="text/javascript" src="https://docs.python.org/2/_static/copybutton.js"></script>

    <link rel="icon" type="image/png" sizes="32x32" href="../../../_static/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../_static/favicon-16x16.png">

    <link href="https://fonts.googleapis.com/css?family=Alike|Noto+Sans" rel="stylesheet">

  </head><body>

<a href="https://github.com/SciTools/iris">
    <img class="github-forkme" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
         alt="Fork Iris on GitHub" />
</a>


<div class="header-content">
    <a href="../../../index.html">
        <img src="../../../_static/Iris7_1_trim_100.png" alt="Iris logo" />
    </a>
    <div class="strapline">
      <h1>
          Iris <span class="version">v2.3</span>
      </h1>
      <p>
         A powerful, format-agnostic, community-driven Python library for analysing and
         visualising Earth science data.
      </p>
    </div>
</div>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="cartography.html" title="iris.analysis.cartography"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../analysis.html" title="iris.analysis"
             accesskey="P">previous</a> |</li>
        <li><a href="../../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../../examples/index.html">examples</a>|&nbsp;</li>
        <li><a href="../../../gallery.html">gallery</a>|&nbsp;</li>
        <li><a href="../../../contents.html">contents</a>|&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../../iris.html" >Iris reference documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../analysis.html" accesskey="U">iris.analysis</a> &#187;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="../analysis.html"
                        title="previous chapter">iris.analysis</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="cartography.html"
                        title="next chapter">iris.analysis.cartography</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/iris/iris/analysis/calculus.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="iris-analysis-calculus">
<span id="id1"></span><h1>iris.analysis.calculus<a class="headerlink" href="#iris-analysis-calculus" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-iris.analysis.calculus"></span><p>Calculus operations on <a class="reference internal" href="../cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">iris.cube.Cube</span></code></a> instances.</p>
<p>See also: <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/index.html#module-numpy" title="(in NumPy v1.17)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">NumPy</span></code></a>.</p>
<p>In this module:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#iris.analysis.calculus.cube_delta" title="iris.analysis.calculus.cube_delta"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cube_delta</span></code></a></p></li>
<li><p><a class="reference internal" href="#iris.analysis.calculus.differentiate" title="iris.analysis.calculus.differentiate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">differentiate</span></code></a></p></li>
<li><p><a class="reference internal" href="#iris.analysis.calculus.curl" title="iris.analysis.calculus.curl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">curl</span></code></a></p></li>
</ul>
</div></blockquote>
<dl class="function">
<dt id="iris.analysis.calculus.cube_delta">
<code class="sig-prename descclassname">iris.analysis.calculus.</code><code class="sig-name descname">cube_delta</code><span class="sig-paren">(</span><em class="sig-param">cube</em>, <em class="sig-param">coord</em><span class="sig-paren">)</span><a class="headerlink" href="#iris.analysis.calculus.cube_delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a cube calculate the difference between each value in the
given coord’s direction.</p>
<p>Args:</p>
<ul class="simple">
<li><dl class="simple">
<dt>coord</dt><dd><p>either a Coord instance or the unique name of a coordinate in the cube.
If a Coord instance is provided, it does not necessarily have to
exist in the cube.</p>
</dd>
</dl>
</li>
</ul>
<p>Example usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">change_in_temperature_wrt_pressure</span> <span class="o">=</span> <span class="n">cube_delta</span><span class="p">(</span><span class="n">temperature_cube</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Missing data support not yet implemented.</p>
</div>
</dd></dl>

<p class="hr_p"><a href="#">&uarr;&#32&#32 top &#32&#32&uarr;</a></p>
<!--<hr class="docutils" />
--><dl class="function">
<dt id="iris.analysis.calculus.differentiate">
<code class="sig-prename descclassname">iris.analysis.calculus.</code><code class="sig-name descname">differentiate</code><span class="sig-paren">(</span><em class="sig-param">cube</em>, <em class="sig-param">coord_to_differentiate</em><span class="sig-paren">)</span><a class="headerlink" href="#iris.analysis.calculus.differentiate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the differential of a given cube with respect to the
coord_to_differentiate.</p>
<p>Args:</p>
<ul class="simple">
<li><dl class="simple">
<dt>coord_to_differentiate:</dt><dd><p>Either a Coord instance or the unique name of a coordinate which
exists in the cube.
If a Coord instance is provided, it does not necessarily have to
exist on the cube.</p>
</dd>
</dl>
</li>
</ul>
<p>Example usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u_wind_acceleration</span> <span class="o">=</span> <span class="n">differentiate</span><span class="p">(</span><span class="n">u_wind_cube</span><span class="p">,</span> <span class="s1">&#39;forecast_time&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The algorithm used is equivalent to:</p>
<div class="math">
<p><img src="../../../_images/math/767f808b4887e5ff1b99a9b173334dda7c661e2b.png" alt="d_i = \frac{v_{i+1}-v_i}{c_{i+1}-c_i}"/></p>
</div><p>Where <code class="docutils literal notranslate"><span class="pre">d</span></code> is the differential, <code class="docutils literal notranslate"><span class="pre">v</span></code> is the data value, <code class="docutils literal notranslate"><span class="pre">c</span></code> is
the coordinate value and <code class="docutils literal notranslate"><span class="pre">i</span></code> is the index in the differential
direction. Hence, in a normal situation if a cube has a shape
(x: n; y: m) differentiating with respect to x will result in a cube
of shape (x: n-1; y: m) and differentiating with respect to y will
result in (x: n; y: m-1). If the coordinate to differentiate is
<a class="reference internal" href="../coords.html#iris.coords.DimCoord.circular" title="iris.coords.DimCoord.circular"><code class="xref py py-attr docutils literal notranslate"><span class="pre">circular</span></code></a> then the resultant
shape will be the same as the input cube.</p>
<p>In the returned cube the <cite>coord_to_differentiate</cite> object is
redefined such that the output coordinate values are set to the
averages of the original coordinate values (i.e. the mid-points).
Similarly, the output lower bounds values are set to the averages of
the original lower bounds values and the output upper bounds values
are set to the averages of the original upper bounds values. In more
formal terms:</p>
<ul class="simple">
<li><p><cite>C[i] = (c[i] + c[i+1]) / 2</cite></p></li>
<li><p><cite>B[i, 0] = (b[i, 0] + b[i+1, 0]) / 2</cite></p></li>
<li><p><cite>B[i, 1] = (b[i, 1] + b[i+1, 1]) / 2</cite></p></li>
</ul>
<p>where <cite>c</cite> and <cite>b</cite> represent the input coordinate values and bounds,
and <cite>C</cite> and <cite>B</cite> the output coordinate values and bounds.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Difference method used is the same as <a class="reference internal" href="#iris.analysis.calculus.cube_delta" title="iris.analysis.calculus.cube_delta"><code class="xref py py-func docutils literal notranslate"><span class="pre">cube_delta()</span></code></a>
and therefore has the same limitations.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Spherical differentiation does not occur in this routine.</p>
</div>
</dd></dl>

<p class="hr_p"><a href="#">&uarr;&#32&#32 top &#32&#32&uarr;</a></p>
<!--<hr class="docutils" />
--><dl class="function">
<dt id="iris.analysis.calculus.curl">
<code class="sig-prename descclassname">iris.analysis.calculus.</code><code class="sig-name descname">curl</code><span class="sig-paren">(</span><em class="sig-param">i_cube</em>, <em class="sig-param">j_cube</em>, <em class="sig-param">k_cube=None</em><span class="sig-paren">)</span><a class="headerlink" href="#iris.analysis.calculus.curl" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the 2-dimensional or 3-dimensional spherical or cartesian
curl of the given vector of cubes.</p>
<p>As well as the standard x and y coordinates, this function requires each
cube to possess a vertical or z-like coordinate (representing some form
of height or pressure).  This can be a scalar or dimension coordinate.</p>
<p>Args:</p>
<ul class="simple">
<li><dl class="simple">
<dt>i_cube</dt><dd><p>The i cube of the vector to operate on</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>j_cube</dt><dd><p>The j cube of the vector to operate on</p>
</dd>
</dl>
</li>
</ul>
<p>Kwargs:</p>
<ul class="simple">
<li><dl class="simple">
<dt>k_cube</dt><dd><p>The k cube of the vector to operate on</p>
</dd>
</dl>
</li>
</ul>
<p>Return (i_cmpt_curl_cube, j_cmpt_curl_cube, k_cmpt_curl_cube)</p>
<p>If the k-cube is not passed in then the 2-dimensional curl will
be calculated, yielding the result: [None, None, k_cube].
If the k-cube is passed in, the 3-dimensional curl will
be calculated, returning 3 component cubes.</p>
<p>All cubes passed in must have the same data units, and those units
must be spatially-derived (e.g. ‘m/s’ or ‘km/h’).</p>
<p>The calculation of curl is dependent on the type of
<a class="reference internal" href="../coord_systems.html#iris.coord_systems.CoordSystem" title="iris.coord_systems.CoordSystem"><code class="xref py py-func docutils literal notranslate"><span class="pre">CoordSystem()</span></code></a> in the cube.
If the <a class="reference internal" href="../coord_systems.html#iris.coord_systems.CoordSystem" title="iris.coord_systems.CoordSystem"><code class="xref py py-func docutils literal notranslate"><span class="pre">CoordSystem()</span></code></a> is either
GeogCS or RotatedGeogCS, the spherical curl will be calculated; otherwise
the cartesian curl will be calculated:</p>
<blockquote>
<div><p>Cartesian curl</p>
<blockquote>
<div><p>When cartesian calculus is used, i_cube is the u component,
j_cube is the v component and k_cube is the w component.</p>
<p>The Cartesian curl is defined as:</p>
<div class="math">
<p><img src="../../../_images/math/133cdfefdd9ef0d198eba1a05b27eb3651401370.png" alt="\nabla\times \vec u =
(\frac{\delta w}{\delta y} - \frac{\delta v}{\delta z})\vec a_i
-
(\frac{\delta w}{\delta x} - \frac{\delta u}{\delta z})\vec a_j
+
(\frac{\delta v}{\delta x} - \frac{\delta u}{\delta y})\vec a_k"/></p>
</div></div></blockquote>
<p>Spherical curl</p>
<blockquote>
<div><p>When spherical calculus is used, i_cube is the <img class="math" src="../../../_images/math/fffd2357ee88a9c50ba9e831ed64c39c73d54a07.png" alt="\phi"/> vector
component (e.g. eastward), j_cube is the <img class="math" src="../../../_images/math/8a87f04e7d7cca18343c084cceca5237fae62491.png" alt="\theta"/> component
(e.g. northward) and k_cube is the radial component.</p>
<p>The spherical curl is defined as:</p>
<div class="math">
<p><img src="../../../_images/math/23379a301932fe477782b1d8aee53725ed2bf1ef.png" alt="\nabla\times \vec A = \frac{1}{r cos \theta}
(\frac{\delta}{\delta \theta}
(\vec A_\phi cos \theta) -
\frac{\delta \vec A_\theta}{\delta \phi}) \vec r +
\frac{1}{r}(\frac{1}{cos \theta}
\frac{\delta \vec A_r}{\delta \phi} -
\frac{\delta}{\delta r} (r \vec A_\phi))\vec \theta +
\frac{1}{r}
(\frac{\delta}{\delta r}(r \vec A_\theta) -
\frac{\delta \vec A_r}{\delta \theta}) \vec \phi"/></p>
</div><p>where phi is longitude, theta is latitude.</p>
</div></blockquote>
</div></blockquote>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="cartography.html" title="iris.analysis.cartography"
             >next</a> |</li>
        <li class="right" >
          <a href="../analysis.html" title="iris.analysis"
             >previous</a> |</li>
        <li><a href="../../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../../examples/index.html">examples</a>|&nbsp;</li>
        <li><a href="../../../gallery.html">gallery</a>|&nbsp;</li>
        <li><a href="../../../contents.html">contents</a>|&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../../iris.html" >Iris reference documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../analysis.html" >iris.analysis</a> &#187;</li> 
      </ul>
    </div>

    <div class="footer">
    <p style="text-align: left; float: left; margin: 0px; padding: 0 0 0 5px;">Documentation licensed under the <a href="http://reference.data.gov.uk/id/open-government-licence" rel="license">Open Government Licence</a></p>
        &copy; <a href="../../../copyright.html">British Crown Copyright</a> 2010 - 2019, Met Office
    </div>

    <!-- Include a version switcher to easily move between the documentation of different versions -->
    <script type=text/javascript src="/iris/docs/version_switch.js" async></script>

  </body>
</html>